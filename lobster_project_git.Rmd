---
title: "lobster_project"
author: "Jason Johns, Robert Heim"
date: "11/14/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

1. Lobster abundance & fishing pressure (2012-2017)

```{r}
# Load packages & data
library(tidyverse)

abundance <- read_csv("lobster_size_abundance.csv")
traps <- read_csv("lobster_traps.csv")

```

```{r}
# Lobster abundances totals at all five sites 2012-2017
abundance_summary <- abundance %>% 
  ggplot(aes(x = YEAR, y = COUNT, group = SITE, fill = SITE, color = SITE)) +
  stat_summary(fun.y = sum, geom = "line") +
  theme_classic() +
  scale_y_continuous(expand = c(0,0), limits = c(0,800)) +
  scale_x_continuous(expand = c(0,0)) +
  labs(title = "Lobster abundance counts at 5 locations from 2012-2017",
       x = "Year",
       y = "Counts") %>% 

abundance_summary

# Creating table of totals by site
site_sums_year <- abundance %>% 
  group_by(SITE) %>% 
  group_by(YEAR) %>% 
  select("YEAR", "SITE", "COUNT")%>% 
  mutate(COUNTS = as.numeric("COUNT"))
  #mutate(totals = sum("COUNT"))
  #rowsum("COUNT", SITE, reorder = TRUE, na.rm = FALSE) 
  #spread(COUNT, n)
  #   rowsum(COUNT, YEAR)
  # )
  
site_sums_year
# run a t-test to compare 2012 & 2017 at MPAs & non-MPAs


```


```{r}
# Trap totals at each site 2012-2017. There were no traps at the MPAs (IVEE & NAPL)
traps_summary <- traps %>% 
  filter(SITE != "ABUR", SITE != "GOLB", SITE != "AHND", SITE != "AHND to AQUE", SITE != "IVEE", SITE != "NAPL") %>% 
  filter(TRAPS != "-99999") %>% 
  ggplot(aes(x = YEAR, y = TRAPS, group = SITE, fill = SITE, color = SITE)) +
  stat_summary(fun.y = sum, geom = "line") +
  theme_classic() +
  scale_y_continuous(expand = c(0,0),  limits = c(0,1300)) +
  scale_x_continuous(expand = c(0,0)) +
  labs(title = "Lobster abundance counts at 5 locations from 2012-2017",
  x = "Year",
  y = "# of traps")

traps_summary

```

